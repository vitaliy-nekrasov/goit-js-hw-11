{"mappings":"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","sources":["src/infinite-scroll-page.js"],"sourcesContent":["import PixabayApiService from './js/pixabay-api';\nimport { Notify } from 'notiflix/build/notiflix-notify-aio';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst pixabayApiService = new PixabayApiService();\nconst { formEl, galleryEl, containerEl } = {\n  formEl: document.querySelector('.search-form'),\n  galleryEl: document.querySelector('.gallery'),\n};\nlet isPageLoad = true;\n\nformEl.addEventListener('submit', onSubmitForm);\n\nasync function onSubmitForm(evt) {\n  try {\n    evt.preventDefault();\n    pixabayApiService.query = evt.currentTarget.elements.searchQuery.value;\n    const resetPage = await pixabayApiService.resetPage();\n    const removeGalleryMarkup = await removeGallery();\n    const pictures = await pixabayApiService.getPictures(\n      pixabayApiService.query\n    );\n    if (pictures.length === 0) {\n      return Notify.failure(\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n    }\n    const totalPictures = await pixabayApiService.totalHits(\n      pixabayApiService.query\n    );\n    Notify.info(`Hooray! We found ${totalPictures} images.`);\n    const markup = await pixabayApiService.galleryMarkup(pictures);\n    const gallery = await createGallery(markup);\n    const lastEl = await document.querySelector('.img:last-child');\n    isPageLoad = true;\n    if (isPageLoad) {\n      const observe = await observeLastEl(lastEl);\n      isPageLoad = false;\n    }\n    const scroll = await startSmoothScroll();\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nasync function createGallery(markup) {\n  const createMarkup = await galleryEl.insertAdjacentHTML('beforeend', markup);\n\n  let gallery = new SimpleLightbox('.gallery a');\n  gallery.on('show.simplelightbox');\n}\n\nasync function removeGallery() {\n  const remove = await (galleryEl.innerHTML = '');\n  return remove;\n}\n\nasync function startSmoothScroll() {\n  const { height: cardHeight } = document\n    .querySelector('body')\n    .firstElementChild.getBoundingClientRect();\n\n  const scroll = await window.scrollBy({\n    top: cardHeight,\n    behavior: 'smooth',\n  });\n}\n\nasync function showMoreImg() {\n  try {\n    const pictures = await pixabayApiService.getPictures(\n      pixabayApiService.query\n    );\n    const markup = await pixabayApiService.galleryMarkup(pictures);\n    const gallery = await createGallery(markup);\n    const lastEl = await document.querySelector('.img:last-child');\n    isPageLoad = true;\n    if (isPageLoad) {\n      observeLastEl(lastEl);\n      isPageLoad = false;\n    }\n    if (pictures.length < 39) {\n      Notify.warning(\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n      infiniteScroll.unobserve(lastEl);\n    }\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nasync function observeLastEl(element) {\n  infiniteScroll.observe(element);\n}\n\nconst infiniteScrollCallback = (entries, observer) => {\n  const entry = entries[0];\n  if (!entry.isIntersecting) return;\n  showMoreImg();\n  observer.unobserve(entry.target);\n};\nconst infiniteScroll = new IntersectionObserver(infiniteScrollCallback, {});\n"],"names":["$bpxeT","parcelRequire","$b2dcfe898af0bb45$var$pixabayApiService","$8H72y","default","$b2dcfe898af0bb45$var$ref","formEl","document","querySelector","galleryEl","$b2dcfe898af0bb45$var$galleryEl","$b2dcfe898af0bb45$var$_onSubmitForm","$parcel$interopDefault","$2TvXO","mark","_callee","evt","pictures","totalPictures","markup","lastEl","preventDefault","query","currentTarget","elements","searchQuery","value","resetPage","_ctx","sent","$b2dcfe898af0bb45$var$removeGallery","getPictures","length","$h6c0i","Notify","failure","totalHits","info","concat","galleryMarkup","$b2dcfe898af0bb45$var$createGallery","$b2dcfe898af0bb45$var$observeLastEl","$b2dcfe898af0bb45$var$startSmoothScroll","console","log","t0","apply","this","arguments","$b2dcfe898af0bb45$var$_createGallery","insertAdjacentHTML","$5IjG7","on","$b2dcfe898af0bb45$var$_removeGallery","remove","innerHTML","$b2dcfe898af0bb45$var$_startSmoothScroll","ref1","cardHeight","firstElementChild","getBoundingClientRect","height","window","scrollBy","top","behavior","$b2dcfe898af0bb45$var$_showMoreImg","warning","$b2dcfe898af0bb45$var$infiniteScroll","unobserve","element","$b2dcfe898af0bb45$var$_observeLastEl","observe","addEventListener","IntersectionObserver","entries","observer","entry","isIntersecting","$b2dcfe898af0bb45$var$showMoreImg","target"],"version":3,"file":"infinite-scroll-page.d7f60385.js.map"}