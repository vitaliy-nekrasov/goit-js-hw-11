{"mappings":"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","sources":["src/infinite-scroll-page.js"],"sourcesContent":["import PixabayApiService from './js/pixabay-api';\nimport galleryMarkup from './js/gallery-markup';\nimport { Notify } from 'notiflix/build/notiflix-notify-aio';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst pixabayApiService = new PixabayApiService();\nconst { formEl, galleryEl } = {\n  formEl: document.querySelector('.search-form'),\n  galleryEl: document.querySelector('.gallery'),\n};\nlet isPageLoad = true;\n\nformEl.addEventListener('submit', onSubmitForm);\n\nasync function onSubmitForm(evt) {\n  try {\n    evt.preventDefault();\n    const showLoader = await loaderShow();\n    pixabayApiService.query =\n      evt.currentTarget.elements.searchQuery.value.trim();\n    if (pixabayApiService.query === '') {\n      return;\n    }\n    const resetPage = await pixabayApiService.resetPage();\n    const removeGalleryMarkup = await removeGallery();\n    const response = await pixabayApiService.getPictures(\n      pixabayApiService.query\n    );\n    const pictures = await response.data.hits;\n    const totalPictures = await response.data.totalHits;\n    Notify.info(`Hooray! We found ${totalPictures} images.`);\n    if (pictures.length === 0) {\n      return Notify.failure(\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n    }\n\n    const markup = await galleryMarkup(pictures);\n    const gallery = await createGallery(markup);\n    const lastEl = await document.querySelector('.img:last-child');\n    isPageLoad = true;\n    if (isPageLoad) {\n      const observe = await observeLastEl(lastEl);\n      isPageLoad = false;\n    }\n    if (pictures.length < 39) {\n      infiniteScroll.unobserve(lastEl);\n    }\n    const scroll = await startSmoothScroll();\n    const hideLoader = await loaderHide();\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nasync function createGallery(markup) {\n  const createMarkup = await galleryEl.insertAdjacentHTML('beforeend', markup);\n\n  let gallery = new SimpleLightbox('.gallery a');\n  gallery.on('show.simplelightbox');\n}\n\nasync function removeGallery() {\n  const remove = await (galleryEl.innerHTML = '');\n  return remove;\n}\n\nasync function startSmoothScroll() {\n  const { height: cardHeight } = document\n    .querySelector('body')\n    .firstElementChild.getBoundingClientRect();\n\n  const scroll = await window.scrollBy({\n    top: cardHeight,\n    behavior: 'smooth',\n  });\n}\n\nasync function showMoreImg() {\n  try {\n    const showLoader = await loaderShow();\n    const response = await pixabayApiService.getPictures(\n      pixabayApiService.query\n    );\n    const pictures = await response.data.hits;\n    const markup = await galleryMarkup(pictures);\n    const gallery = await createGallery(markup);\n    const lastEl = await document.querySelector('.img:last-child');\n    isPageLoad = true;\n    const hideLoader = await loaderHide();\n    if (isPageLoad) {\n      observeLastEl(lastEl);\n      isPageLoad = false;\n    }\n    if (pictures.length < 39) {\n      Notify.warning(\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n      infiniteScroll.unobserve(lastEl);\n    }\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nasync function observeLastEl(element) {\n  infiniteScroll.observe(element);\n}\n\nconst infiniteScrollCallback = (entries, observer) => {\n  const entry = entries[0];\n  if (!entry.isIntersecting) return;\n  showMoreImg();\n  observer.unobserve(entry.target);\n};\nconst infiniteScroll = new IntersectionObserver(infiniteScrollCallback, {});\n\nconst maskEl = document.querySelector('.mask');\n\nwindow.addEventListener('DOMContentLoaded', onWindowLoad);\n\nfunction onWindowLoad() {\n  maskEl.classList.add('hide');\n}\n\nfunction loaderShow() {\n  maskEl.classList.remove('hide');\n}\n\nfunction loaderHide() {\n  maskEl.classList.add('hide');\n}\n"],"names":["$bpxeT","parcelRequire","$b2dcfe898af0bb45$var$pixabayApiService","$8H72y","default","$b2dcfe898af0bb45$var$ref","formEl","document","querySelector","galleryEl","$b2dcfe898af0bb45$var$galleryEl","$b2dcfe898af0bb45$var$isPageLoad","$b2dcfe898af0bb45$var$_onSubmitForm","$parcel$interopDefault","$2TvXO","mark","_callee","evt","response","pictures","totalPictures","markup","lastEl","preventDefault","$b2dcfe898af0bb45$var$loaderShow","_ctx","sent","query","currentTarget","elements","searchQuery","value","trim","resetPage","$b2dcfe898af0bb45$var$removeGallery","getPictures","data","hits","totalHits","$h6c0i","Notify","info","concat","length","failure","$3PHHA","$b2dcfe898af0bb45$var$createGallery","$b2dcfe898af0bb45$var$observeLastEl","$b2dcfe898af0bb45$var$infiniteScroll","unobserve","$b2dcfe898af0bb45$var$startSmoothScroll","$b2dcfe898af0bb45$var$loaderHide","console","log","t0","apply","this","arguments","$b2dcfe898af0bb45$var$_createGallery","insertAdjacentHTML","$5IjG7","on","$b2dcfe898af0bb45$var$_removeGallery","remove","innerHTML","$b2dcfe898af0bb45$var$_startSmoothScroll","ref1","cardHeight","firstElementChild","getBoundingClientRect","height","window","scrollBy","top","behavior","$b2dcfe898af0bb45$var$_showMoreImg","warning","element","$b2dcfe898af0bb45$var$_observeLastEl","observe","addEventListener","IntersectionObserver","entries","observer","entry","isIntersecting","$b2dcfe898af0bb45$var$showMoreImg","target","$b2dcfe898af0bb45$var$maskEl","classList","add"],"version":3,"file":"infinite-scroll-page.de6769e1.js.map"}